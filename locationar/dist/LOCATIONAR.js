!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.LOCATIONAR=e():t.LOCATIONAR=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=3)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),o=function(){function t(){}return t.setDefault=function(t,e){return void 0!==t?t:e},t}();e.GeoUtil=o;var s=function(){function t(){}return t.degToRad=function(t){return.0174532925199432*t},t.radToDeg=function(t){return 57.29577951308232*t},t.limit=function(t,e,i){return Math.max(Math.min(t,i),e)},t.getFlatCoordDistance=function(e,i){var n=this.degToRad(i.x-e.x),o=this.degToRad(i.z-e.z),s=Math.sin(n/2)*Math.sin(n/2)+Math.sin(o/2)*Math.sin(o/2)*Math.cos(e.x)*Math.cos(i.x),r=Math.atan2(Math.sqrt(s),Math.sqrt(1-s));return 2*t.EARTHRADIUS*r},t.coordTo3dSpace=function(e,i){var n=this.degToRad(e.x-i.x),o=this.degToRad(e.z-i.z),s=e.y-i.y;return{x:-(t.EARTHRADIUS*n),y:s,z:t.EARTHRADIUS*o*Math.cos(this.degToRad(i.x))}},t.coordOffsetGpsSpace=function(e,i){var n=i.x/t.EARTHRADIUS,o=i.z/Math.cos(this.degToRad(e.x))/t.EARTHRADIUS,s=e.y+i.y;return{x:e.x+this.radToDeg(n),y:s,z:e.z+this.radToDeg(o)}},t.interpolate=function(e,i,o,s){var r=e.pos,a=i.pos,h=t.limit((s-o)/(i.time-e.time),0,1),c=new n.Vector3;return c.x=r.x+(a.x-r.x)*h,c.y=r.y+(a.y-r.y)*h,c.z=r.z+(a.z-r.z)*h,c},t.EARTHRADIUS=6371e3,t.PI=3.141592653589793,t}();e.GeoMath=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i};e.Vector3=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),o=function(t,e){var i=n.GeoMath.coordTo3dSpace(t,e);this.x=i.x,this.y=i.y,this.z=i.z};e.GpsLocation=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(4);e.Source=n.Source;var o=i(5);e.LocationProvider=o.LocationProvider;var s=i(6);e.DirectionProvider=s.DirectionProvider;var r=i(8);e.BrightnessProvider=r.BrightnessProvider;var a=i(2);e.GpsLocation=a.GpsLocation;var h=i(0);e.GeoMath=h.GeoMath},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){var e=this,i=Math.max(window.innerWidth,window.innerHeight)*window.devicePixelRatio,n=i/4*3;this.parameters={parent:document.body,canvas:null,onResize:null,camera:null,deviceId:null,facingMode:"environment",sourceWidth:i,sourceHeight:n},this.setParameters(t),void 0===this.parameters.canvas&&console.info("canvas have to be provided, otherwise resize won't work"),this.parameters.onResize||(this.parameters.onResize=function(t,e){t.onResizeElement(),e&&null!==e&&t.copyElementSizeTo(e)});var o=this;this.initialize().then(function(){var t=o.parameters;null!==t.camera&&e.stream&&e.domElement&&(t.camera.aspect=4/3,t.camera.updateProjectionMatrix()),window.addEventListener("resize",function(){t.onResize&&t.onResize(o,t.canvas)}),t.onResize&&t.onResize(o,t.canvas)})}return t.prototype.initialize=function(){var t=this;return new Promise(function(e,i){var n=t._initSourceWebcam(function(){t.domElement?(t.onResizeElement(),t.parameters.parent.appendChild(t.domElement),e()):i("domElement not defined")},function(t){i(t)});if(n)return t.domElement=n,t.positionSourceDomElement(),t;i("Webcam source could not be established")})},t.prototype.dispose=function(){this.parameters.parent&&this.domElement&&this.parameters.parent.removeChild(this.domElement)},t.prototype.onResizeElement=function(){if(this.domElement){var t=window.innerWidth,e=window.innerHeight,i=0,n=0;this.domElement&&(n=this.domElement.videoWidth,i=this.domElement.videoHeight);var o=n/i;if(t/e<o){var s=o*e;this.domElement.style.width=s+"px",this.domElement.style.marginLeft=-(s-t)/2+"px",this.domElement.style.height=e+"px",this.domElement.style.marginTop="0px"}else{var r=1/(o/t);this.domElement.style.height=r+"px",this.domElement.style.marginTop=-(r-e)/2+"px",this.domElement.style.width=t+"px",this.domElement.style.marginLeft="0px"}}else console.warn("Can't resize as domElement is not defined on source")},t.prototype.copyElementSizeTo=function(t){this.domElement?window.innerWidth>window.innerHeight?(t.style.width=this.domElement.style.width,t.style.height=this.domElement.style.height,t.style.marginLeft=this.domElement.style.marginLeft,t.style.marginTop=this.domElement.style.marginTop):(t.style.height=this.domElement.style.height,t.style.width=4*parseInt(t.style.height,10)/3+"px",t.style.marginLeft=(window.innerWidth-parseInt(t.style.width,10))/2+"px",t.style.marginTop="0"):console.warn("Cant set size to match domElement as it is not defined")},t.prototype._initSourceWebcam=function(t,e){var i=this,n=document.createElement("video");if(n.setAttribute("autoplay",""),n.setAttribute("muted",""),n.setAttribute("playsinline",""),void 0===navigator.mediaDevices||void 0===navigator.mediaDevices.enumerateDevices||void 0===navigator.mediaDevices.getUserMedia){var o="";return void 0===navigator.mediaDevices?o="navigator.mediaDevices":void 0===navigator.mediaDevices.enumerateDevices?o="navigator.mediaDevices.enumerateDevices":void 0===navigator.mediaDevices.getUserMedia&&(o="navigator.mediaDevices.getUserMedia"),void e("WebRTC issue-! "+o+" not present in your browser")}var s=this;return navigator.mediaDevices.enumerateDevices().then(function(o){var r={audio:!1,video:{facingMode:i.parameters.facingMode,width:{ideal:i.parameters.sourceWidth},height:{ideal:i.parameters.sourceHeight},resizeMode:"none",aspectRatio:{ideal:4/3}}};null!==i.parameters.deviceId&&(r.video.deviceId={exact:i.parameters.deviceId}),navigator.mediaDevices.getUserMedia(r).then(function(e){s.stream=e,n.srcObject=e,document.body.addEventListener("click",function(){n.play()}),n.addEventListener("loadedmetadata",function(e){t()})}).catch(function(t){e(t)})}).catch(function(t){e(t)}),n},t.prototype.positionSourceDomElement=function(){this.domElement&&(this.domElement.style.position="absolute",this.domElement.style.top="0px",this.domElement.style.left="0px",this.domElement.style.zIndex="-1")},t.prototype.setParameters=function(t){if(t)for(var e in t)if(e){var i=t[e];if(void 0===i){console.warn(e+"' parameter is undefined.");continue}if(void 0===this.parameters[e]){console.warn(e+"' is not a property of this Source.");continue}this.parameters[e]=i}},t}();e.Source=n,e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),o=i(0),s=i(1),r=function(){function t(t){var e=this;if(this.localPosition=new s.Vector3,this.gpsZero=new s.Vector3,this.useGpsAltitude=!1,this.lastPositionArrived=Date.now(),this.lastPositionTimestamp=0,this.gpsOptions={enableHighAccuracy:!0,maximumAge:0,timeout:1/0},this.gpsZero=t.gpsZero,this.cameraHeight=o.GeoUtil.setDefault(t.cameraHeight,1.6),this.useGpsAltitude=o.GeoUtil.setDefault(t.useGpsAltitude,!1),this.callback=o.GeoUtil.setDefault(t.callback,function(t){}),this.gpsZero||(console.info("gpsZero is required"),this.gpsZero=new s.Vector3),navigator.geolocation){this.watchID=navigator.geolocation.watchPosition(function(t){e.gpsPosition=t,e.updatePosition()},function(t){return e.onLocationError(t,console.info)},this.gpsOptions)}else console.info("Geolocation is not supported by your browser")}return t.prototype.getLocation=function(){return this.localPosition},t.prototype.getDebug=function(){return this.gpsPosition},t.prototype.updatePosition=function(){if(this.gpsPosition&&this.gpsPosition.timestamp!==this.lastPositionTimestamp){var t=this.gpsPosition.coords;if(t.latitude&&t.longitude){var e=t.altitude?t.altitude:0,i=this.useGpsAltitude&&t.altitude?e:this.cameraHeight,r=new s.Vector3(t.latitude,i,t.longitude),a=new n.GpsLocation(r,this.gpsZero),h=new s.Vector3(-a.x,a.y,a.z);this.lastPositionTimestamp=this.gpsPosition.timestamp,this.lastPositionArrived=Date.now(),this.position1=this.position2,this.position2={pos:h,time:this.gpsPosition.timestamp}}}return void 0!==this.position1&&void 0!==this.position2&&(this.localPosition=o.GeoMath.interpolate(this.position1,this.position2,this.lastPositionArrived,Date.now())),this.callback(this),this.localPosition},t.prototype.dispose=function(){this.watchID&&navigator.geolocation.clearWatch(this.watchID)},t.prototype.setCameraHeight=function(t){this.cameraHeight=t},t.prototype.setGpsZero=function(t){this.gpsZero=t},t.prototype.onLocationError=function(t,e){switch(t.code){case t.PERMISSION_DENIED:e("User denied permission for Geolocation");break;case t.POSITION_UNAVAILABLE:e("Location information is unavailable");break;case t.TIMEOUT:e("The request to get user location timedout");break;default:throw t}},t}();e.LocationProvider=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),o=i(7),s=i(1),r=function(){function t(t){this.alphaOffset=n.GeoMath.degToRad(-90),this.enabled=!0,this.debug={alpha:0,beta:0,gamma:0,absolute:!1},this.quaternion=new o.Quaternion,this.screenOrientation=0,this.zee=new s.Vector3(0,0,1),this.q0=new o.Quaternion,this.q1=new o.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),this.callback=n.GeoUtil.setDefault(t.callback,function(t){});var e=this;this.onDeviceOrientationChangeEvent=function(t){e.updateDeviceOrientation(t)},this.onScreenOrientationChangeEvent=function(){e.screenOrientation=window.orientation||0},this.connect()}return t.prototype.getDirection=function(){return this.quaternion},t.prototype.getDebug=function(){return this.debug},t.prototype.updateDeviceOrientation=function(t){if(this.enabled&&t){var e=t.absolute,i=t.alpha?n.GeoMath.degToRad(t.alpha):0,o=t.beta?n.GeoMath.degToRad(t.beta):0,s=t.gamma?n.GeoMath.degToRad(t.gamma):0;!1===e&&t.webkitCompassHeading&&t.webkitCompassAccuracy&&t.webkitCompassAccuracy>0&&t.webkitCompassAccuracy<50&&t.webkitCompassHeading>0&&(i=t.webkitCompassHeading,e=!0),i=(i+360)%360,this.debug={alpha:i,beta:o,gamma:s,absolute:e};var r=this.screenOrientation?n.GeoMath.degToRad(this.screenOrientation):0;this.setObjectQuaternion(this.quaternionFromOrientation(i+this.alphaOffset,o,s,r))}},t.prototype.dispose=function(){this.disconnect()},t.prototype.quaternionFromOrientation=function(t,e,i,n){var r=(new o.Quaternion).setFromEuler(new s.Vector3(e,t,-i),"YXZ");return r.multiply(this.q1),r.multiply(this.q0.setFromAxisAngle(this.zee,-n)),r},t.prototype.setObjectQuaternion=function(t){var e=200*(1-Math.abs(t.dot(this.quaternion)));this.quaternion.slerp(t,n.GeoMath.limit(e,0,1)),this.callback(this)},t.prototype.connect=function(t){this.onScreenOrientationChangeEvent(),window.addEventListener("orientationchange",this.onScreenOrientationChangeEvent,!1),"ondeviceorientationabsolute"in window&&(!t||"absoluteOrientation"===t)?window.addEventListener("deviceorientationabsolute",this.onDeviceOrientationChangeEvent,!1):"ondeviceorientation"in window&&(!t||"deviceOrientation"===t)?window.addEventListener("deviceorientation",this.onDeviceOrientationChangeEvent,!1):console.info("No Orientation sensors avalible"),this.enabled=!0},t.prototype.disconnect=function(){window.removeEventListener("orientationchange",this.onScreenOrientationChangeEvent,!1),this.sensor&&this.sensor.stop(),"ondeviceorientationabsolute"in window?window.removeEventListener("deviceorientationabsolute",this.onDeviceOrientationChangeEvent,!1):"ondeviceorientation"in window&&window.removeEventListener("deviceorientation",this.onDeviceOrientationChangeEvent,!1),this.enabled=!1},t}();e.DirectionProvider=r},function(t,e,i){"use strict";function n(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1}i.r(e),i.d(e,"Quaternion",function(){return n}),Object.assign(n,{slerp:function(t,e,i,n){return i.copy(t).slerp(e,n)},slerpFlat:function(t,e,i,n,o,s,r){var a=i[n+0],h=i[n+1],c=i[n+2],u=i[n+3],l=o[s+0],d=o[s+1],p=o[s+2],m=o[s+3];if(u!==m||a!==l||h!==d||c!==p){var _=1-r,f=a*l+h*d+c*p+u*m,v=f>=0?1:-1,y=1-f*f;if(y>Number.EPSILON){var g=Math.sqrt(y),w=Math.atan2(g,f*v);_=Math.sin(_*w)/g,r=Math.sin(r*w)/g}var b=r*v;if(a=a*_+l*b,h=h*_+d*b,c=c*_+p*b,u=u*_+m*b,_===1-r){var x=1/Math.sqrt(a*a+h*h+c*c+u*u);a*=x,h*=x,c*=x,u*=x}}t[e]=a,t[e+1]=h,t[e+2]=c,t[e+3]=u}}),Object.defineProperties(n.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(n.prototype,{isQuaternion:!0,set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){var i=t.x,n=t.y,o=t.z,s=Math.cos,r=Math.sin,a=s(i/2),h=s(n/2),c=s(o/2),u=r(i/2),l=r(n/2),d=r(o/2);return"XYZ"===e?(this._x=u*h*c+a*l*d,this._y=a*l*c-u*h*d,this._z=a*h*d+u*l*c,this._w=a*h*c-u*l*d):"YXZ"===e?(this._x=u*h*c+a*l*d,this._y=a*l*c-u*h*d,this._z=a*h*d-u*l*c,this._w=a*h*c+u*l*d):"ZXY"===e?(this._x=u*h*c-a*l*d,this._y=a*l*c+u*h*d,this._z=a*h*d+u*l*c,this._w=a*h*c-u*l*d):"ZYX"===e?(this._x=u*h*c-a*l*d,this._y=a*l*c+u*h*d,this._z=a*h*d-u*l*c,this._w=a*h*c+u*l*d):"YZX"===e?(this._x=u*h*c+a*l*d,this._y=a*l*c+u*h*d,this._z=a*h*d-u*l*c,this._w=a*h*c-u*l*d):"XZY"===e&&(this._x=u*h*c-a*l*d,this._y=a*l*c-u*h*d,this._z=a*h*d+u*l*c,this._w=a*h*c+u*l*d),this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,n=i[0],o=i[4],s=i[8],r=i[1],a=i[5],h=i[9],c=i[2],u=i[6],l=i[10],d=n+a+l;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(u-h)*e,this._y=(s-c)*e,this._z=(r-o)*e):n>a&&n>l?(e=2*Math.sqrt(1+n-a-l),this._w=(u-h)/e,this._x=.25*e,this._y=(o+r)/e,this._z=(s+c)/e):a>l?(e=2*Math.sqrt(1+a-n-l),this._w=(s-c)/e,this._x=(o+r)/e,this._y=.25*e,this._z=(h+u)/e):(e=2*Math.sqrt(1+l-n-a),this._w=(r-o)/e,this._x=(s+c)/e,this._y=(h+u)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var i=t.dot(e)+1;return i<1e-6?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(Math.max(Math.min(this.dot(t),1),-1)))},rotateTowards:function(t,e){var i=this.angleTo(t);if(0===i)return this;var n=Math.min(1,e/i);return this.slerp(t,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,o=t._z,s=t._w,r=e._x,a=e._y,h=e._z,c=e._w;return this._x=i*c+s*r+n*h-o*a,this._y=n*c+s*a+o*r-i*h,this._z=o*c+s*h+i*a-n*r,this._w=s*c-i*r-n*a-o*h,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,n=this._y,o=this._z,s=this._w,r=s*t._w+i*t._x+n*t._y+o*t._z;if(r<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,r=-r):this.copy(t),r>=1)return this._w=s,this._x=i,this._y=n,this._z=o,this;var a=1-r*r;if(a<=Number.EPSILON){var h=1-e;return this._w=h*s+e*this._w,this._x=h*i+e*this._x,this._y=h*n+e*this._y,this._z=h*o+e*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(a),u=Math.atan2(c,r),l=Math.sin((1-e)*u)/c,d=Math.sin(e*u)/c;return this._w=s*l+this._w*d,this._x=i*l+this._x*d,this._y=n*l+this._y*d,this._z=o*l+this._z*d,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),o=function(){function t(t){var e=this;this.illuminance=0,this.avalible=!1,this.callback=n.GeoUtil.setDefault(t.callback,function(t){}),"AmbientLightSensor"in window&&"permissions"in navigator?navigator.permissions.query({name:"ambient-light-sensor"}).then(function(t){if("denied"!==t.state){var i=new AmbientLightSensor;i.onerror=function(t){return e.onSensorError(t,console.info)},i.onreading=function(){e.illuminance=i.illuminance,e.avalible=!0,e.callback(e)},i.start()}else console.info("Permission to use ambient light sensor is denied.")}):(this.avalible=!1,console.info("Sensor is not supported by the User Agent."))}return t.prototype.isAvalible=function(){return this.avalible},t.prototype.getIlluminance=function(){return this.illuminance},t.prototype.getBrightness=function(){return n.GeoMath.limit(Math.log(this.illuminance+1)/Math.LN10/5,0,1)},t.prototype.getLightPower=function(t){return void 0===t&&(t=1),4*n.GeoMath.PI*this.getBrightness()*t},t.prototype.onSensorError=function(t,e){switch(t.error.name){case"NotAllowedError":e("You need to request permission for the ambientlightsensor first");break;case"NotReadableError":e("Cannot connect to the ambientlightsensor sensor");break;default:throw t.error}},t}();e.BrightnessProvider=o}])});
//# sourceMappingURL=LOCATIONAR.js.map